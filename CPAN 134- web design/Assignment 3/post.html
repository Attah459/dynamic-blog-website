<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blog Post</title>
</head>
<body>

  <h1 id="post-title"></h1>
  <p id="post-content"></p>
  <img id="post-image" />

  <hr />

  <button id="edit-btn">Edit</button>

  <form id="edit-form" hidden>
    <label>
      Title:<br />
      <input type="text" id="edit-title" />
    </label>
    <br /><br />

    <label>
      Content:<br />
      <textarea id="edit-content" rows="5"></textarea>
    </label>
    <br /><br />

    <button type="submit">Save Changes</button>
    <button type="button" id="cancel-btn">Cancel</button>
  </form>

  <p id="error-msg"></p>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const postId = urlParams.get("id");
    const posts = JSON.parse(localStorage.getItem("posts")) || [];

    const titleEl = document.getElementById("post-title");
    const contentEl = document.getElementById("post-content");
    const imageEl = document.getElementById("post-image");
    const editBtn = document.getElementById("edit-btn");
    const editForm = document.getElementById("edit-form");
    const editTitle = document.getElementById("edit-title");
    const editContent = document.getElementById("edit-content");
    const cancelBtn = document.getElementById("cancel-btn");
    const errorMsg = document.getElementById("error-msg");

    if (!postId || !posts[postId]) {
      titleEl.textContent = "Post not found.";
      editBtn.hidden = true;
    } else {
      const post = posts[postId];
      titleEl.textContent = post.title;
      contentEl.textContent = post.content;

      if (post.image) {
        imageEl.src = post.image;
      } else {
        imageEl.hidden = true;
      }

      editBtn.addEventListener("click", () => {
        editTitle.value = post.title;
        editContent.value = post.content;
        editForm.hidden = false;
        errorMsg.textContent = "";
      });

      cancelBtn.addEventListener("click", () => {
        editForm.hidden = true;
        errorMsg.textContent = "";
      });

      editForm.addEventListener("submit", function (e) {
        e.preventDefault();

        const newTitle = editTitle.value.trim();
        const newContent = editContent.value.trim();

        if (!newTitle || !newContent) {
          errorMsg.textContent = "Title and content cannot be empty.";
          return;
        }

        posts[postId].title = newTitle;
        posts[postId].content = newContent;
        localStorage.setItem("posts", JSON.stringify(posts));

        titleEl.textContent = newTitle;
        contentEl.textContent = newContent;

        editForm.hidden = true;
        errorMsg.textContent = "";
      });
    }
  </script>
</body>
</html>
